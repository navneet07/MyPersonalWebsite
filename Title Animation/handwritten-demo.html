<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>i am root - Handwritten Animation</title>
    <style>
        html {
            min-height: 100vh;
        }
        body {
            background-color: #232435;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
        }

        .container {
            text-align: center;
        }

        svg {
            width: 80vw;
            max-width: 600px;
            height: auto;
        }

        .demo-title {
            color: #7d7f8e;
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.8;
        }

        .restart-btn {
            margin-top: 2rem;
            padding: 12px 24px;
            background: linear-gradient(45deg, #64C898, #7d7f8e);
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .restart-btn:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="demo-title">"i am root" - Handwritten Signature</div>
        
        <div id="svg-container">
            <!-- SVG will be loaded dynamically from finalTitle.svg -->
        </div>

        <button class="restart-btn" onclick="restartAnimation()">Restart Animation</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/MotionPathPlugin.min.js"></script>
    
    <script>
        gsap.registerPlugin(MotionPathPlugin);

        let timeline;

        function restartAnimation() {
            if (timeline) {
                timeline.restart();
            }
        }

        function startAnimation() {
            if (timeline) {
                timeline.play(0);
            }
        }

        // Load the finalTitle.svg and set up animation
        async function loadSVGAndSetupAnimation() {
            try {
                const response = await fetch('finalTitle.svg');
                const svgText = await response.text();
                
                // Parse the SVG
                const parser = new DOMParser();
                const doc = parser.parseFromString(svgText, 'image/svg+xml');
                const svg = doc.querySelector('svg');
                
                // Preserve the original viewBox but make it responsive
                svg.style.width = '80vw';
                svg.style.maxWidth = '600px';
                svg.style.height = 'auto';
                
                // Get the main path (inside the nested groups)
                const mainPath = svg.querySelector('path');
                if (mainPath) {
                    // Style the original path for visibility
                    mainPath.setAttribute('fill', 'none');
                    mainPath.setAttribute('stroke', '#393b54');
                    mainPath.setAttribute('stroke-width', '2');
                    mainPath.setAttribute('stroke-linecap', 'round');
                    mainPath.setAttribute('stroke-linejoin', 'round');
                    mainPath.classList.add('loop');
                    
                    // Remove the fill from parent groups to prevent black fill
                    const groups = svg.querySelectorAll('g');
                    groups.forEach(group => {
                        group.setAttribute('fill', 'none');
                    });
                    
                    // Create animation effect paths (clones of the main path)
                    const boopPath = mainPath.cloneNode(true);
                    boopPath.classList.remove('loop');
                    boopPath.classList.add('boop');
                    boopPath.setAttribute('opacity', '0');
                    boopPath.setAttribute('stroke', '#7d7f8e');
                    boopPath.setAttribute('fill', 'none');
                    
                    const boop2Path = mainPath.cloneNode(true);
                    boop2Path.classList.remove('loop');
                    boop2Path.classList.add('boop2');
                    boop2Path.setAttribute('opacity', '0');
                    boop2Path.setAttribute('stroke', '#7d7f8e');
                    boop2Path.setAttribute('fill', 'none');
                    
                    // Add the effect paths to the same parent group as the main path
                    const parentGroup = mainPath.parentElement;
                    parentGroup.appendChild(boopPath);
                    parentGroup.appendChild(boop2Path);
                    
                    // Add the traveling ball
                    const ball = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    ball.classList.add('ball');
                    ball.setAttribute('r', '1.5');
                    ball.setAttribute('fill', '#64C898');
                    parentGroup.appendChild(ball);
                    
                    // Insert the SVG into the container
                    document.getElementById('svg-container').appendChild(svg);
                    
                    // Setup animation
                    setupAnimation();
                } else {
                    throw new Error('No path found in SVG');
                }
                
            } catch (error) {
                console.log('Could not load finalTitle.svg, using fallback:', error);
                // Fallback text
                document.getElementById('svg-container').innerHTML = `
                    <h1 style="color: #393b54; font-size: 4rem; text-align: center;">i am root</h1>
                `;
            }
        }

        function setupAnimation() {
            // Setup - hide everything initially
            gsap.set(".boop", {opacity: 0});
            gsap.set(".boop2", {opacity: 0});
            gsap.set(".ball", {
                xPercent: -50,
                yPercent: -50,
                transformOrigin: "50%, 50%"
            });

            const startBall = 0.02;
            const endBall = 0.98;

            timeline = gsap.timeline({paused: true});
            
            // Initial boop effect
            timeline.to(".boop", {
                duration: 0.5,
                ease: "power4.out",
                opacity: 0.3
            })
            .to(".boop", {
                duration: 0.3,
                ease: "back.out(8)",
                opacity: 0
            }, "+=0.1")
            
            // Ball travels along the handwritten path
            .to(".ball", {
                duration: 15,
                ease: "power1.inOut",
                motionPath: {
                    path: ".loop",
                    align: ".loop",
                    start: startBall,
                    end: endBall,
                }
            }, 0.65)
            
            // End boop effect
            .to(".boop2", {
                duration: 0.5,
                ease: "power4.out",
                opacity: 0.3
            }, 12)
            .to(".boop2", {
                duration: 0.3,
                ease: "back.out(8)",
                opacity: 0
            }, 12.5)
            
            // Ball returns
            .to(".ball", {
                duration: 15,
                ease: "power1.inOut",
                motionPath: {
                    path: ".loop",
                    align: ".loop",
                    start: endBall,
                    end: startBall
                }
            }, 13)
            
            // Auto restart
            .add(() => {
                setTimeout(startAnimation, 1500);
            }, 28);

            // Start the animation
            setTimeout(startAnimation, 500);
        }

        // Load SVG when page loads
        window.addEventListener('load', () => {
            loadSVGAndSetupAnimation();
        });
    </script>
</body>
</html>
